<div class="container p-4">
  <div class="main">
    <div class="row m-0 text-center" style="height: 10%">
      <h1>My Bookings</h1>
    </div>
    <div
      class="d-flex p-3 align-items-center justify-content-start"
      style="height: 15%"
    >
      <div class="col-2 me-2">
        <button
          type="button"
          class="btn btn-confirm btn-lg"
          [class.pressed]="selected === 'ACTIVE'"
          (click)="select('ACTIVE')"
        >
          Active
        </button>
      </div>
      <div class="col-2 me-2">
        <button
          type="button"
          class="btn btn-confirm btn-lg"
          [class.pressed]="selected === 'COMPLETED'"
          (click)="select('COMPLETED')"
        >
          Completed
        </button>
      </div>
      <div class="col-2 me-2">
        <button
          type="button"
          class="btn btn-confirm btn-lg"
          [class.pressed]="selected === 'CANCELLED'"
          (click)="select('CANCELLED')"
        >
          Canceled
        </button>
      </div>
      <div class="col-6"></div>
    </div>
    <div class="d-grid p-3" style="height: 75%; overflow-y: auto">
      <div
        *ngFor="let r of reservations"
        class="card mb-3"
        style="max-height: 220px"
      >
        <div class="row g-0 align-items-stretch">
          <div class="col-md-4">
            <img
              src="pexels-quark-studio-1159039-3201921.jpg"
              class="img-fluid rounded-start"
              alt="poza"
              style="height: 100%; object-fit: cover"
            />
          </div>
          <div class="col-md-8 fundal-card">
            <div class="card-body d-flex flex-column h-100 mt-2">
              <h5 class="card-title">
                <!-- room reservation -->
                <ng-container *ngIf="r.roomId != null; else seatTitle">
                  {{ r.roomName || "Room" }}
                </ng-container>
                <ng-template #seatTitle>Seat {{ r.seatNumber }}</ng-template>
              </h5>

              <p class="card-text flex-grow-1">
                <ng-container *ngIf="r.roomId != null; else seatDetails">
                  <div>
                    <strong>Start:</strong>
                    {{ r.reservationDateStart | date : "yyyy-MM-dd HH:mm" }}
                  </div>
                  <div>
                    <strong>End:</strong>
                    {{ r.reservationDateEnd | date : "yyyy-MM-dd HH:mm" }}
                  </div>
                  <div *ngIf="r.buildingName || r.floorName">
                    <small>
                      {{ r.buildingName ? r.buildingName + " - " : "" }}
                      {{ r.floorName ? r.floorName : "" }}
                    </small>
                  </div>
                </ng-container>

                <ng-template #seatDetails>
                  <div><strong>Floor:</strong> {{ r.floorName }}</div>
                  <div>
                    <strong>Date:</strong>
                    {{ r.reservationDateStart | date : "yyyy-MM-dd" }}
                  </div>
                </ng-template>
              </p>

              <div class="d-flex justify-content-end">
                <button
                  *ngIf="r.status === 'ACTIVE'"
                  class="btn btn-cancel btn-lg"
                  (click)="cancelReservation(r.id)"
                  [disabled]="cancellingIds.has(r.id)"
                >
                  <ng-container *ngIf="cancellingIds.has(r.id); else canLabel"
                    >Cancelling...</ng-container
                  >
                  <ng-template #canLabel>Cancel</ng-template>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
